PaymentPage.Component["admin-dashboard"]={container:{},configuration:{},data:{},_currentlyDisplayed:"",_resumeQuickSetup:!1,_skipQuickSetup:!1,_xhrSetPaymentMethodStatusMAP:{},Init:function(a){this.container=a;let e=this;payment_page_component_configuration_parse(this,(function(){PaymentPage.Template.preload("admin-dashboard",["template/_navigation.html","template/_payment-gateways.html","template/_templates.html"],(function(){e._loadData()}))}))},_loadData:function(){let a=this;PaymentPage.setLoadingContent(this.container),PaymentPage.API.fetch("payment-page/v1/administration/dashboard",!1,(function(e){"object"==typeof e?(a.data=e,a._loadTemplate()):PaymentPage.setFailedAssetFetchContent(a.container)}))},_getTemplateArgs:function(){let a=this,e=payment_page_parse_args(this.data,this.configuration);return e.current_page=payment_page_hashtag_container_from_browser(this.container),"payment-gateways"!==e.current_page&&"templates"!==e.current_page&&(e.current_page="payment-gateways"),e.quick_setup_index=!1,e.quick_setup_return_index=!1,e.quick_setup_skip_index=!1,jQuery.each(e.quick_setup_steps,(function(t,n){if(n.is_completed&&!a._resumeQuickSetup)return!0;if(!1!==e.quick_setup_index){if(void 0===n.requires_steps)return e.quick_setup_skip_index=t,!1;if(a._resumeQuickSetup)return!0;let i=!0;return jQuery.each(n.requires_steps,(function(a,t){return!!e.quick_setup_steps[t].is_completed||(i=!1,!1)})),!i||(e.quick_setup_skip_index=t,!1)}e.quick_setup_index=t})),!1!==this._skipQuickSetup&&(e.quick_setup_return_index=e.quick_setup_index,e.quick_setup_index=this._skipQuickSetup,e.quick_setup_skip_index=!1),"templates"===e.current_page&&!1===e.quick_setup_return_index&&!1===e.quick_setup_skip_index&&(e.quick_setup_return_index=0),!1===e.quick_setup_index||this.data.quick_setup_skipped||(e.current_page=e.quick_setup_steps[e.quick_setup_index].template,e.current_page!==payment_page_hashtag_container_from_browser(this.container)&&(this.container.attr("data-payment-page-hashtag-identifier",e.current_page),payment_page_hashtag_container_to_browser(this.container))),e},_loadTemplate:function(){let a=this,e=this._getTemplateArgs();this._currentlyDisplayed=e.current_page,this.container.attr("data-payment-page-hashtag-identifier",this._currentlyDisplayed),PaymentPage.Template.load(this.container,"admin-dashboard","template/default.html",e,(function(){a._bindQuickSetupEvents(),a._bindTemplateEvents(),a._bindPaymentEvents();let e=payment_page_get_cookie("payment_page_dashboard_open_gateway");null==e&&(e="stripe"),"none"!==e&&a.container.find('[data-payment-page-has-payment-methods="1"][data-payment-page-gateway-alias="'+e+'"] > [data-payment-page-component-admin-dashboard-section="header"] > h2').trigger("click")}))},_bindQuickSetupEvents:function(){let a=this;this.container.find('[data-payment-page-component-admin-dashboard-trigger="quick-setup"]').on("click",(function(){PaymentPage.setLoadingContent(jQuery(this),"","mini"),a.data.quick_setup_skipped=0,a._resumeQuickSetup=!0,a._loadTemplate()})),this.container.find('[data-payment-page-component-admin-dashboard-trigger="quick-setup-exit"]').on("click",(function(){PaymentPage.setLoadingContent(jQuery(this),"","mini"),a.data.quick_setup_skipped=1,PaymentPage.API.post("payment-page/v1/administration/set-quick-setup-skip",{status:1},(function(e){a.data=e,a._loadTemplate()}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger^="quick_setup_skip_"]').on("click",(function(){PaymentPage.setLoadingContent(jQuery(this),"","mini"),a._skipQuickSetup=parseInt(jQuery(this).attr("data-payment-page-component-admin-dashboard-trigger").replace("quick_setup_skip_","")),a._loadTemplate()})),this.container.find('[data-payment-page-component-admin-dashboard-trigger="quick_setup_return"]').on("click",(function(){PaymentPage.setLoadingContent(jQuery(this),"","mini"),a._skipQuickSetup=!1,a._loadTemplate()}))},_bindTemplateEvents:function(){let a=this;this.container.find('[data-payment-page-component-admin-dashboard-trigger="install_plugin_elementor"]').on("click",(function(){if(void 0!==jQuery(this).attr("disabled"))return;if(jQuery(this).find(".payment-page-application-loader-wrapper").length>0)return;PaymentPage.setLoadingContent(jQuery(this),"","mini"),a.container.find('[data-payment-page-component-admin-dashboard-trigger="install_plugin_elementor"]').not(jQuery(this)).attr("disabled","disabled");let e=jQuery(this).parents('[data-payment-page-component-admin-dashboard-section="template_information"]:first');e.find("[data-payment-page-notification]").remove(),PaymentPage.API.post("payment-page/v1/plugin/install",{identifier:"elementor"},(function(t){void 0===t.message?PaymentPage.API.post("payment-page/v1/plugin/activate",{identifier:"elementor"},(function(e){a._loadData()})):e.append('<div data-payment-page-notification="danger">'+t.message+"</div>")}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger="activate_plugin_elementor"]').on("click",(function(){if(void 0!==jQuery(this).attr("disabled"))return;if(jQuery(this).find(".payment-page-application-loader-wrapper").length>0)return;let e=jQuery(this).parents('[data-payment-page-component-admin-dashboard-section="template_information"]:first');e.find("[data-payment-page-notification]").remove(),PaymentPage.setLoadingContent(jQuery(this),"","mini"),a.container.find('[data-payment-page-component-admin-dashboard-trigger="activate_plugin_elementor"]').not(jQuery(this)).attr("disabled","disabled"),PaymentPage.API.post("payment-page/v1/plugin/activate",{identifier:"elementor"},(function(t){void 0===t.message?a._loadData():e.append('<div data-payment-page-notification="danger">'+t.message+"</div>")}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger^="select_template_"]').on("click",(function(){if(void 0!==jQuery(this).attr("disabled"))return;if(jQuery(this).find(".payment-page-application-loader-wrapper").length>0)return;let e=jQuery(this).parents('[data-payment-page-component-admin-dashboard-section="template_information"]:first');e.find("[data-payment-page-notification]").remove(),PaymentPage.setLoadingContent(jQuery(this),"","mini"),a.container.find('[data-payment-page-component-admin-dashboard-trigger^="select_template_"]').not(jQuery(this)).attr("disabled","disabled"),PaymentPage.API.post("payment-page/v1/administration/import-template",{id:parseInt(jQuery(this).attr("data-payment-page-component-admin-dashboard-trigger").replace("select_template_",""))},(function(t){void 0!==t.message&&e.append('<div data-payment-page-notification="'+(void 0!==t.code?"danger":"success")+'">'+t.message+"</div>"),a.container.find('[data-payment-page-component-admin-dashboard-trigger^="select_template_"]').removeAttr("disabled").html(a.data.lang.template_select)}))}))},_bindPaymentEvents:function(){let a=this;this.container.find('[data-payment-page-has-payment-methods="1"] > [data-payment-page-component-admin-dashboard-section="header"] > h2').on("click",(function(){let a=jQuery(this).parents("[data-payment-page-has-payment-methods]"),e=a.find('[data-payment-page-component-admin-dashboard-section="payment_methods_container"]');parseInt(a.attr("data-payment-page-has-payment-methods-visible"))?(a.attr("data-payment-page-has-payment-methods-visible",0),e.slideUp("slow"),payment_page_set_cookie("payment_page_dashboard_open_gateway","none",43200)):(a.attr("data-payment-page-has-payment-methods-visible",1),e.slideDown("slow"),payment_page_set_cookie("payment_page_dashboard_open_gateway",a.attr("data-payment-page-gateway-alias"),43200))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger="gateway_mode_checkbox"]').on("change",(function(){let e=jQuery(this).is(":checked")?"test":"live";jQuery(this).parents("[data-payment-page-gateway-mode]").attr("data-payment-page-gateway-mode",e),a.data.payment_gateway.stripe.mode=e,PaymentPage.API.post("payment-page/v1/payment-gateway/set-mode",{payment_gateway:jQuery(this).parents("[data-payment-page-gateway-alias]:first").attr("data-payment-page-gateway-alias"),is_live:jQuery(this).is(":checked")?0:1},(function(a){}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger^="payment_method_"]').on("change",(function(){let e=jQuery(this).parents("[data-payment-page-gateway-alias]:first").attr("data-payment-page-gateway-alias"),t=jQuery(this).attr("data-payment-page-component-admin-dashboard-trigger").replace("payment_method_",""),n=jQuery(this).parents("td:first");jQuery(this).is(":checked")?a.data.payment_gateway[e].payment_methods_enabled.push(t):a.data.payment_gateway[e].payment_methods_enabled=a.data.payment_gateway.stripe.payment_methods_enabled.filter((function(a,e,n){return a!==t})),n.find(" > label").hide(),n.append(payment_page_element_loader("mini")),void 0!==a._xhrSetPaymentMethodStatusMAP[e]&&!1!==a._xhrSetPaymentMethodStatusMAP[e]&&a._xhrSetPaymentMethodStatusMAP[e].abort(),a._xhrSetPaymentMethodStatusMAP[e]=PaymentPage.API.post("payment-page/v1/payment-gateway/set-payment-methods",{payment_gateway:e,payment_methods:a.data.payment_gateway[e].payment_methods_enabled},(function(t){"object"==typeof t&&"ok"===t.status&&(void 0!==t.refresh&&parseInt(t.refresh)&&a._loadData(),a._xhrSetPaymentMethodStatusMAP[e]=!1,a.container.find('[data-payment-page-component-admin-dashboard-trigger^="payment_method_"]').each((function(){let a=jQuery(this).parents("td:first");a.find(" > label").is(":hidden")&&(a.find(".payment-page-application-loader-wrapper").remove(),a.find(" > label").show())})))}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger^="gateway_connect_"],[data-payment-page-component-admin-dashboard-trigger^="gateway_settings_"]').on("click",(function(){if(jQuery(this).find(".payment-page-application-loader-wrapper").length>0)return;if(parseInt(PaymentPage.settings.is_https)&&-1===window.location.href.indexOf(PaymentPage.settings.site_url))return void PaymentPage.Library.Popup.display('<div data-payment-page-notification="danger">'+a.data.lang.notification_url_mismatch_ssl.replace("%s",jQuery(this).parents("[data-payment-page-gateway-alias]:first").find('> [data-payment-page-component-admin-dashboard-section="header"]:first > h2').text())+"</div>");let e=[];if(jQuery.each(a.data.invalid_url_characters,(function(a,t){-1!==PaymentPage.settings.site_url.indexOf(t)&&e.push(t)})),e.length>0)return void PaymentPage.Library.Popup.display('<div data-payment-page-notification="danger">'+a.data.lang.notification_url_invalid_characters.replace("%s","<strong>"+e.join(" ")+"</strong>").replace("%s",jQuery(this).parents("[data-payment-page-gateway-alias]:first").find('> [data-payment-page-component-admin-dashboard-section="header"]:first > h2').text())+"</div>");let t=jQuery(this),n=jQuery(this).parents("[data-payment-page-gateway-alias]:first"),i="live"===jQuery(this).attr("data-payment-page-component-admin-dashboard-trigger").replace("gateway_connect_","").replace("gateway_settings_","")?1:0,p=n.attr("data-payment-page-gateway-alias"),s=jQuery(this).html();PaymentPage.setLoadingContent(jQuery(this),"","mini"),PaymentPage.API.fetch("payment-page/v1/payment-gateway/connect",{payment_gateway:p,is_live:i},(function(e){if("redirect"!==e.type){if("settings"===e.type){let r=n.find(' > [data-payment-page-component-admin-dashboard-section="header"] > h2 ').text()+' <span data-payment-page-mode="'+(i?"live":"test")+'">'+(i?a.data.lang.payment_gateway_mode_live:a.data.lang.payment_gateway_mode_test)+"</span>";r=a.data.lang.payment_gateway_settings_title.replace("%s",r),t.html(s),PaymentPage.Library.Popup.display('<div data-payment-page-component="admin-form" data-payment-page-component-args="'+_.escape(JSON.stringify({title:r,description:e.description,fields:e.fields,operations:e.operations,rest_data:{payment_gateway:p,is_live:i},rest_path:"payment-page/v1/payment-gateway/save-settings"}))+'"></div>',{trigger_app_init:!0}),PaymentPage.Library.Popup.getContainerObject().find('[data-payment-page-component="admin-form"]').on("payment_page_settings_saved",(function(){PaymentPage.Library.Popup.close(),a._loadData()}))}}else window.location=e.url}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger^="gateway_disconnect_"]').on("click",(function(){PaymentPage.setLoadingContent(jQuery(this),"","mini"),PaymentPage.API.post("payment-page/v1/payment-gateway/disconnect",{payment_gateway:jQuery(this).parents("[data-payment-page-gateway-alias]:first").attr("data-payment-page-gateway-alias"),is_live:"live"===jQuery(this).attr("data-payment-page-component-admin-dashboard-trigger").replace("gateway_disconnect_","")?1:0},(function(e){a._loadData()}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger^="payment_method-settings_"]').on("click",(function(){let e=jQuery(this),t=jQuery(this).parents("[data-payment-page-gateway-alias]:first").attr("data-payment-page-gateway-alias"),n=JSON.parse(e.attr("data-payment-page-component-admin-dashboard-args")),i=e.attr("data-payment-page-component-admin-dashboard-trigger").replace("payment_method-settings_",""),p="live"===i.substr(0,4)?1:0,s=i.replace(p?"live_":"test_","");PaymentPage.Library.Popup.display('<div data-payment-page-component="admin-form" data-payment-page-component-args="'+_.escape(JSON.stringify({title:n.title,description:n.description,fields:n.fields,operations:{save:{label:a.data.lang.payment_method_settings_save,type:"save",order:1}},rest_data:{payment_gateway:t,payment_method:s,is_live:p},rest_path:"payment-page/v1/payment-gateway/save-payment-method-settings"}))+'"></div>',{trigger_app_init:!0}),PaymentPage.Library.Popup.getContainerObject().find('[data-payment-page-component="admin-form"]').on("payment_page_settings_saved",(function(){PaymentPage.Library.Popup.close(),a._loadData()}))})),this.container.find('[data-payment-page-component-admin-dashboard-trigger^="payment_gateway_webhook_settings_"]').on("click",(function(){let e=jQuery(this),t=jQuery(this).parents("[data-payment-page-gateway-alias]:first").attr("data-payment-page-gateway-alias"),n=JSON.parse(e.attr("data-payment-page-component-admin-dashboard-args")),i="live"===e.attr("data-payment-page-component-admin-dashboard-trigger").replace("payment_gateway_webhook_settings_","").substr(0,4)?1:0;PaymentPage.Library.Popup.display('<div data-payment-page-component="admin-form" data-payment-page-component-args="'+_.escape(JSON.stringify({title:n.title,description:n.description,fields:n.fields,operations:{save:{label:a.data.lang.payment_gateway_webhook_settings_save,type:"save",order:1}},rest_data:{payment_gateway:t,is_live:i},rest_path:"payment-page/v1/payment-gateway/save-webhook-settings"}))+'"></div>',{trigger_app_init:!0}),PaymentPage.Library.Popup.getContainerObject().find('[data-payment-page-component="admin-form"]').on("payment_page_settings_saved",(function(){PaymentPage.Library.Popup.close(),a._loadData()}))}))},__onWindowHashChange:function(a){0===parseInt(this.data.quick_setup_skipped)&&PaymentPage.API.post("payment-page/v1/administration/set-quick-setup-skip",{status:1},(function(a){})),a!==this._currentlyDisplayed&&this._loadTemplate()}};