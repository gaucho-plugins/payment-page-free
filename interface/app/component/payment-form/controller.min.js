PaymentPage.Component["payment-form"]={container:{},configuration:{uniqid:"",is_free_version:0,currency_symbol:0,subscription_selector:0,currency_selector:0,post_id:"",pricing_plans:[],field_map:{},submit_actions:[],submit_trigger_label:{token_order:[],token_map:{customText1:"",customText2:"",customText3:""}},pricing_plan_option_label:{token_order:[],token_map:{select_field_custom_text:"",select_field_separator_text:""}},lang:{invalid_email_address:"",pricing_plan_title:"",payment_information:"",payment_method:"",pricing_custom_amount:"",confirmation_page_title:"",confirmation_page_message:"",confirmation_page_item:"",confirmation_page_customer_name:"",confirmation_page_email:"",confirmation_page_payment_date:"",confirmation_page_payment_amount:"",notification_payment_failed:"",payment_method_wallet_prerender:"",payment_method_wallet_incompatible:"",payment_method_one_time_only_tooltip:""},payment_gateways:{stripe:{publishable_key:"",payment_methods:[]},paypal:{client_id:"",payment_methods:[]}},success_redirect_location:"",success_has_payment_details:1,current_payment_gateway:"",current_payment_method:"",ignore_url_params:0,has_query_string_support:0},paymentGateway:{},_isCustomPricing:!1,paymentTriggerObject:null,paymentTriggerAlternativeContainerObject:null,pricingOptions:[],currencyOptionsAssoc:{},frequencyOptionsAssoc:{},currencyFrequencyOptions:{},fieldList:[],currentPaymentGateway:"",currentPaymentMethod:"",paymentMethodsMap:{},_hiddenFields:{},Init:function(e){this.container=e;let t=this;this.configuration.payment_gateways={},payment_page_component_configuration_parse(this,(function(){if(0===t.configuration.ignore_url_params){const e=new URLSearchParams(window.location.search);if("succeeded"===e.get("redirect_status"))return void t.afterPaymentSuccessURLCallback(e)}jQuery.fn.inputmask?t._inputMaskReady():PaymentPage.LoadAssets(PaymentPage.settings.libraries.inputmask,(function(){t._inputMaskReady()}))}))},_inputMaskReady:function(){let e=this;jQuery.each(this.configuration.payment_gateways,(function(t,n){e.paymentMethodsMap[t]={},jQuery.each(n.payment_methods,(function(n,a){e.paymentMethodsMap[t][a.id]=a}))})),""!==this.configuration.current_payment_gateway&&""!==this.configuration.current_payment_method?(this.currentPaymentGateway=this.configuration.current_payment_gateway,this.currentPaymentMethod=this.configuration.current_payment_method):(this.currentPaymentGateway=Object.keys(this.configuration.payment_gateways)[0],this.currentPaymentMethod=this.configuration.payment_gateways[this.currentPaymentGateway].payment_methods[0].id),PaymentPage.Template.preload("payment-form",["template/payment-information.html"],(function(){e.__initSDKRecursive()}))},__initSDKRecursive:function(){let e=this;null!==e.paymentGateway.stripe.controllerInstance||void 0===this.configuration.payment_gateways.stripe||""===this.configuration.payment_gateways.stripe.publishable_key?null!==e.paymentGateway.paypal.controllerInstance||void 0===this.configuration.payment_gateways.paypal||""===this.configuration.payment_gateways.paypal.client_id?this._init():e.paymentGateway.paypal._init(e,(function(){e.__initSDKRecursive()})):e.paymentGateway.stripe._init(e,(function(){e.__initSDKRecursive()}))},_init:function(){let e=this,t=!1;this.pricingOptions=[],this.currencyOptionsAssoc={},this.frequencyOptionsAssoc={},this.currencyFrequencyOptions={},this.fieldList=[],jQuery.each(Object.values(this.configuration.field_map),(function(t,n){void 0!==n.order&&(n.order=parseInt(n.order)),e.fieldList.push(n)})),this.fieldList=_.sortBy(this.fieldList,"order"),jQuery.each(this.configuration.pricing_plans,(function(t,n){jQuery.each(n.prices,(function(t,a){let i="";jQuery.each(e.configuration.pricing_plan_option_label.token_order,(function(t,r){i+=""===i?"":" ","select_field_plan_name"===r?i+=n.plan_title:"select_field_plan_price"===r?i+=a.price:"select_field_frequency"===r?i+=a.frequency.label:"select_field_plan_price_currency"===r?""===a.price?i+="":i+=e.configuration.currency_symbol?payment_page_get_currency_symbol(payment_page_get_user_locale(),a.currency):a.currency.toUpperCase():"select_field_setup_price"===r?void 0!==a.setup_price&&void 0!==a.has_setup_price&&parseInt(a.has_setup_price)?i+=a.setup_price:i+="":void 0!==e.configuration.pricing_plan_option_label.token_map[r]&&(i+=e.configuration.pricing_plan_option_label.token_map[r])})),""===a.price&&(void 0!==e.configuration.pricing_plan_option_label.token_map.select_field_separator_text&&1===e.configuration.pricing_plan_option_label.token_map.select_field_separator_text.length&&(i=jQuery.trim(payment_page_trim(i,e.configuration.pricing_plan_option_label.token_map.select_field_separator_text))),void 0!==e.configuration.pricing_plan_option_label.token_map.select_field_custom_text&&1===e.configuration.pricing_plan_option_label.token_map.select_field_custom_text.length&&(i=jQuery.trim(payment_page_trim(i,e.configuration.pricing_plan_option_label.token_map.select_field_custom_text))),void 0!==e.configuration.pricing_plan_option_label.token_map.select_field_separator_text&&1===e.configuration.pricing_plan_option_label.token_map.select_field_separator_text.length&&(i=jQuery.trim(payment_page_trim(i,e.configuration.pricing_plan_option_label.token_map.select_field_separator_text)))),void 0===e.currencyFrequencyOptions[a.currency]&&(e.currencyFrequencyOptions[a.currency]=[]),payment_page_in_array(a.frequency.value,e.currencyFrequencyOptions[a.currency])||e.currencyFrequencyOptions[a.currency].push(a.frequency.value),void 0===e.frequencyOptionsAssoc[a.frequency.value]&&(e.frequencyOptionsAssoc[a.frequency.value]=a.frequency.label),void 0===e.currencyOptionsAssoc[a.currency]&&(e.currencyOptionsAssoc[a.currency]=e.configuration.currency_symbol?payment_page_get_currency_symbol(payment_page_get_user_locale(),a.currency):a.currency.toUpperCase());let r={label:i,title:n.plan_title,currency:a.currency,frequency:a.frequency.value,price:a.price};void 0!==a.setup_price&&void 0!==a.has_setup_price&&parseInt(a.has_setup_price)&&(r.setup_price=a.setup_price),e.pricingOptions.push(r)}))}));let n={};if(this.configuration.has_query_string_support){let a=[];const i=new URLSearchParams(window.location.search);if(jQuery.each(this.fieldList,(function(e,t){let r=i.get(t.name);if(null===r){if(void 0!==t.label){let e=t.label.toLowerCase().replaceAll(" ","_");null!==(r=i.get(e))&&a.push(e)}}else a.push(t.name);null!==r&&(void 0===n.field_value_assoc&&(n.field_value_assoc={}),n.field_value_assoc[t.name]=r)})),null!==i.get("currency")&&(n.selected_currency=i.get("currency"),a.push("currency")),null!==i.get("frequency")&&(n.selected_frequency=i.get("frequency"),a.push("frequency")),null!==i.get("amount")&&(n.custom_amount_value=parseFloat(i.get("amount")),a.push("amount")),null!==i.get("gateway")&&null!==i.get("method")&&(e.currentPaymentGateway=i.get("gateway"),e.currentPaymentMethod=i.get("method"),a.push("gateway"),a.push("method")),a.length>=1){let n=location.search.substring(1),i=JSON.parse('{"'+decodeURI(n).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');jQuery.each(i,(function(t,n){payment_page_in_array(t,a)||(e._hiddenFields[t]=n)})),a.length>=3&&(t=!0)}}this._loadTemplate(n,t)},_loadTemplate:function(e,t=!1){let n=this,a=payment_page_clone_object(this.configuration);a.fields_list=this.fieldList,a.payment_gateway=this.currentPaymentGateway,a.payment_method=this.currentPaymentMethod,a.payment_method_handler=this.paymentMethodsMap[this.currentPaymentGateway][this.currentPaymentMethod].payment_method,a.selected_currency=Object.keys(this.currencyOptionsAssoc)[0],a.selected_frequency=this.configuration.subscription_selector?Object.keys(this.frequencyOptionsAssoc)[0]:null,a.currency_options_assoc=this.currencyOptionsAssoc,a.frequency_options_assoc=this.frequencyOptionsAssoc,a.pricing_options_html=this.__pricingOptionsToHTML(this.configuration.currency_selector?void 0!==e.selected_currency?e.selected_currency:a.selected_currency:null,void 0!==e.selected_frequency?e.selected_frequency:a.selected_frequency,void 0!==e.custom_amount_value?e.custom_amount_value:null),a.payment_methods_map=this.paymentMethodsMap,a.payment_methods_counts=0,a.field_value_assoc=[],"object"==typeof e&&Object.keys(e).length>0&&(a=payment_page_parse_args(e,a)),jQuery.each(this.paymentMethodsMap,(function(e,t){a.payment_methods_counts+=Object.keys(t).length})),a.style={pricing_arrow_color:getComputedStyle(this.container[0]).getPropertyValue("--payment-page-element-form-select-arrow-color"),filter_arrow_color:getComputedStyle(this.container[0]).getPropertyValue("--payment-page-element-pricing-filter-select-arrow-color")},a.payment_gateway_warning=this.getCurrentPaymentGatewayWarning(),a.payment_method_disclaimer=this.getCurrentPaymentMethodDisclaimer(),PaymentPage.Template.load(this.container,"payment-form","template/default.html",a,(function(){n.container.find('[name="pp_custom_amount"]').inputmask("decimal",{digits:2,digitsOptional:!1,groupSeparator:","}),n.paymentTriggerObject=n.container.find('[data-payment-page-component-payment-form-trigger="submit"]'),n.paymentTriggerAlternativeContainerObject=n.container.find('[data-payment-page-component-payment-form-container="alternative_submit"]'),n.__refreshPaymentTriggerText(),n.__refreshFilteringRestrictions(),n._bindFiltering(),n._bindFormFields(),n._bindPaymentMethods(),n.__refreshPaymentMethodRestrictions(),n.paymentGateway[n.currentPaymentGateway].mountPaymentMethod(n.currentPaymentMethod,t)}))},__pricingOptionsToHTML:function(e,t,n=null){let a="",i=t+"__"+e+"__"+(null===n?0:n);return jQuery.each(this.pricingOptions,(function(n,r){if(null!==e&&r.currency!==e)return!0;if(null!==t&&r.frequency!==t)return!0;let o=_.escape(r.frequency+"__"+r.currency+"__"+r.price+(void 0!==r.setup_price?"__"+r.setup_price:""));a+='<option data-payment-page-pricing-frequency="'+_.escape(r.frequency)+'" data-payment-page-pricing-currency="'+_.escape(r.currency)+'" data-payment-page-pricing-price="'+_.escape(r.price)+'"',void 0!==r.setup_price&&(a+=' data-payment-page-pricing-setup-price="'+_.escape(r.setup_price)+'"'),a+=' data-payment-page-pricing-title="'+_.escape(r.title)+'" value="'+o+'"'+(i===o?' selected="selected"':"")+">"+_.escape(r.label)+"</option>"})),a},getCheckoutInformation:function(){let e=this.container.find('[name="pp_pricing_options"] option[value="'+this.container.find('[name="pp_pricing_options"]').val()+'"]'),t={title:e.attr("data-payment-page-pricing-title"),frequency:e.attr("data-payment-page-pricing-frequency"),frequency_formatted:void 0!==this.frequencyOptionsAssoc[e.attr("data-payment-page-pricing-frequency")]?this.frequencyOptionsAssoc[e.attr("data-payment-page-pricing-frequency")]:"",currency:e.attr("data-payment-page-pricing-currency"),price:this._isCustomPricing?this.container.find('[name="pp_custom_amount"]').inputmask("unmaskedvalue"):e.attr("data-payment-page-pricing-price"),price_formatted:this._isCustomPricing?this.container.find('[name="pp_custom_amount"]').val():e.attr("data-payment-page-pricing-price")};return void 0!==e.attr("data-payment-page-pricing-setup-price")&&(t.price_setup=e.attr("data-payment-page-pricing-setup-price")),t},__getFilterSelectedCurrency:function(){if(!this.configuration.currency_selector)return null;let e=this.container.find('[data-payment-page-component-payment-form-section="pricing-filter-currency"]');return e.is("select")?e.val():e.find('[data-payment-page-component-payment-form-trigger^="filter_currency_"][data-payment-page-interaction-state="active"]').attr("data-payment-page-component-payment-form-trigger").replace("filter_currency_","")},__getFilterSelectedFrequency:function(){if(!this.configuration.subscription_selector)return null;let e=this.container.find('[data-payment-page-component-payment-form-section="pricing-filter-frequency"]');return e.is("select")?e.val():e.find('[data-payment-page-component-payment-form-trigger^="filter_frequency_"][data-payment-page-interaction-state="active"]').attr("data-payment-page-component-payment-form-trigger").replace("filter_frequency_","")},__refreshPricingOptions:function(){let e=this.__getFilterSelectedCurrency(),t=this.__getFilterSelectedFrequency(),n=this.__pricingOptionsToHTML(e,t);if(""!==n)this.container.find('[name="pp_pricing_options"]').html(n).trigger("change"),this.__refreshFilteringRestrictions();else{let t=this.container.find('[data-payment-page-component-payment-form-section="pricing-filter-frequency"]');if(t.is("select")){let n=this.currencyFrequencyOptions[e][0],a=t.find(' > option[value="'+n+'"]');t.find(" > option").not(a).attr("data-payment-page-interaction-state","inactive"),a.removeAttr("disabled").attr("data-payment-page-interaction-state","active"),t.val(n),t.trigger("change")}else t.find('[data-payment-page-component-payment-form-trigger="filter_frequency_'+this.currencyFrequencyOptions[e][0]+'"]').attr("data-payment-page-interaction-state","inactive").trigger("click")}},__refreshPaymentTriggerText:function(){let e=this,t=this.getCheckoutInformation(),n="";jQuery.each(this.configuration.submit_trigger_label.token_order,(function(a,i){n+=""===n?"":" ","totalPrice"===i?n+=t.price_formatted:"frequency"===i?n+=t.frequency_formatted:"currency"===i?n+=e.configuration.currency_symbol?payment_page_get_currency_symbol(payment_page_get_user_locale(),t.currency):t.currency.toUpperCase():void 0!==e.configuration.submit_trigger_label.token_map[i]&&(n+=e.configuration.submit_trigger_label.token_map[i])})),this.paymentTriggerObject.html(n)},_onPaymentTermsChange:function(){this.__refreshPaymentTriggerText(),"function"==typeof this.paymentGateway[this.currentPaymentGateway].onPaymentTermsChange&&this.paymentGateway[this.currentPaymentGateway].onPaymentTermsChange(this.currentPaymentMethod)},_bindFiltering:function(){let e=this;this.container.find('[data-payment-page-component-payment-form-section="pricing-filter-frequency"],[data-payment-page-component-payment-form-section="pricing-filter-currency"]').on("change",(function(){let t=jQuery(this).find(' > option[value="'+jQuery(this).val()+'"]');e.container.find("> option").not(t).attr("data-payment-page-interaction-state","inactive"),t.attr("data-payment-page-interaction-state","active"),e.__refreshPricingOptions()})),this.container.find('[data-payment-page-component-payment-form-trigger^="filter_frequency_"]').on("click",(function(){"inactive"===jQuery(this).attr("data-payment-page-interaction-state")&&(e.container.find('[data-payment-page-component-payment-form-trigger^="filter_frequency_"]').not(jQuery(this)).attr("data-payment-page-interaction-state","inactive"),jQuery(this).attr("data-payment-page-interaction-state","active"),e.__refreshPricingOptions())})),this.container.find('[data-payment-page-component-payment-form-trigger^="filter_currency_"]').on("click",(function(){"inactive"===jQuery(this).attr("data-payment-page-interaction-state")&&(e.container.find('[data-payment-page-component-payment-form-trigger^="filter_currency_"]').not(jQuery(this)).attr("data-payment-page-interaction-state","inactive"),jQuery(this).attr("data-payment-page-interaction-state","active"),e.__refreshPricingOptions())}))},__refreshFilteringRestrictions:function(){if(!this.configuration.currency_selector||!this.configuration.subscription_selector)return;let e=this,t=this.getCheckoutInformation();this.container.find('[data-payment-page-component-payment-form-section="pricing-filter-frequency"]').find("[data-payment-page-interaction-state]").not('[data-payment-page-interaction-state="active"]').each((function(){let n=void 0!==jQuery(this).attr("data-payment-page-component-payment-form-trigger")?jQuery(this).attr("data-payment-page-component-payment-form-trigger").replace("filter_frequency_",""):jQuery(this).attr("value");payment_page_in_array(n,e.currencyFrequencyOptions[t.currency])?jQuery(this).attr("data-payment-page-interaction-state","inactive").removeAttr("disabled"):jQuery(this).attr("data-payment-page-interaction-state","disabled").attr("disabled","disabled")}))},_bindFormFields:function(){let e=this;this.container.find('[name="pp_pricing_options"]').off("change.payment_page").on("change.payment_page",(function(){let t=e.container.find('[data-payment-page-component-payment-form-section="payment-custom-amount"]');""===jQuery(this).find(' > option[value="'+jQuery(this).val()+'"]').attr("data-payment-page-pricing-price")?(e._isCustomPricing=!0,t.find('[data-payment-page-component-payment-form-section="field_container"] > span').html(payment_page_get_currency_symbol(payment_page_get_user_locale(),jQuery(this).find(' > option[value="'+jQuery(this).val()+'"]').attr("data-payment-page-pricing-currency"))),payment_page_set_display_state_visible(t)):(e._isCustomPricing=!1,payment_page_set_display_state_hidden(t)),e._onPaymentTermsChange(),e.__refreshPaymentMethodRestrictions()})),this.container.find('[name="pp_custom_amount"]').off("keyup.payment_page change.payment_page").on("keyup.payment_page change.payment_page",(function(){e._onPaymentTermsChange()})),""===this.container.find('[name="pp_pricing_options"] > option:first').attr("data-payment-page-pricing-price")&&this.container.find('[name="pp_pricing_options"]').trigger("change"),this.container.find("input[name]").off("focus.payment_page").on("focus.payment_page",(function(){jQuery(this).parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","focus")})),this.container.find("input[name]").off("blur.payment_page").on("blur.payment_page",(function(){jQuery(this).parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state",""===jQuery(this).val()?"blur":"not-empty")})),this.container.find('[name="first_name"], [name="last_name"], [name="card_zip_code"], [name][required]').not('[name="email_address"]').off("keyup.payment_page change.payment_page").on("keyup.payment_page change.payment_page",(function(){e._maybeEnablePaymentTrigger()})),this.container.find('[name="email_address"]').off("keyup.payment_page change.payment_page").on("keyup.payment_page change.payment_page",(function(){let t=e.container.find('[for="'+jQuery(this).attr("id")+'"]');""===jQuery(this).val()?t.attr("data-payment-page-interaction-state","pending").html(e.configuration.field_map.email_address.label):payment_page_is_valid_email(jQuery(this).val())?t.attr("data-payment-page-interaction-state","good").html(e.configuration.field_map.email_address.label):t.attr("data-payment-page-interaction-state","error").html(e.configuration.lang.invalid_email_address),e._maybeEnablePaymentTrigger()}))},_bindPaymentMethods:function(){let e=this;this.container.find('[data-payment-page-component-payment-form-trigger^="switch_payment_method_"]').off("click").on("click",(function(t){t.preventDefault(),e.paymentTriggerObject.find(".payment-page-application-loader-wrapper").length>0||"inactive"===jQuery(this).attr("data-payment-page-interaction-state")&&e.__switchPaymentMethod(jQuery(this).attr("data-payment-page-payment-gateway"),jQuery(this).attr("data-payment-page-component-payment-form-trigger").replace("switch_payment_method_",""))}))},__refreshPaymentMethodRestrictions:function(){let e=this,t=this.getCheckoutInformation(),n=this.container.find('[data-payment-page-component-payment-form-trigger^="switch_payment_method_"]');if("one-time"===t.frequency)n.filter('[data-payment-page-interaction-state="disabled"]').attr("data-payment-page-interaction-state","inactive").removeAttr("data-payment-page-hint").removeAttr("data-payment-page-hint-location").removeAttr("aria-label");else if(1!==parseInt(n.filter('[data-payment-page-interaction-state="active"]').attr("data-payment-page-has-recurring-support"))){let t=n.filter('[data-payment-page-has-recurring-support="1"]:first');if(0===t.length)return e.paymentTriggerObject.hide(),void e.paymentTriggerAlternativeContainerObject.html('<div data-payment-page-notification="warning">No payment method activated for recurring pricing plans.</div>').show();this.__paymentMethodRestrictionsTriggersLock(n.filter('[data-payment-page-has-recurring-support="0"]')),e.__switchPaymentMethod(t.attr("data-payment-page-payment-gateway"),t.attr("data-payment-page-component-payment-form-trigger").replace("switch_payment_method_",""))}else this.__paymentMethodRestrictionsTriggersLock(n.filter('[data-payment-page-has-recurring-support="0"]'))},__paymentMethodRestrictionsTriggersLock:function(e){let t=this,n=payment_page_css_variable_value(this.container,"--payment-page-element-form-payment-method-per-row");e.attr("data-payment-page-interaction-state","disabled").each((function(){let e="top",a=parseInt(jQuery(this).index())%n;0===a?e="right":a===n-1&&(e="left"),jQuery(this).attr("data-payment-page-hint","info").attr("data-payment-page-hint-location",e).attr("aria-label",t.configuration.lang.payment_method_one_time_only_tooltip)}))},__switchPaymentMethod:function(e,t){if(e===this.currentPaymentGateway&&t===this.currentPaymentMethod)return;"function"==typeof this.paymentGateway[this.currentPaymentGateway].unMountPaymentMethod&&this.paymentGateway[this.currentPaymentGateway].unMountPaymentMethod(this.currentPaymentMethod),this.currentPaymentGateway=e,this.currentPaymentMethod=t;let n=this,a=this.container.find('[data-payment-page-component-payment-form-section="payment-information"]');this.container.find("> form > [data-payment-page-notification], > [data-payment-page-notification]").remove(),this.container.find('[data-payment-page-component-payment-form-trigger^="switch_payment_method_"][data-payment-page-interaction-state="active"]').attr("data-payment-page-interaction-state","inactive"),this.container.find('[data-payment-page-component-payment-form-trigger="switch_payment_method_'+this.currentPaymentMethod+'"]').attr("data-payment-page-interaction-state","active"),this.paymentTriggerAlternativeContainerObject.removeAttr("data-payment-page-size").hide(),this.paymentTriggerObject.hide();let i=payment_page_clone_object(this.configuration);i.payment_gateway=this.currentPaymentGateway,i.payment_gateway_warning=this.getCurrentPaymentGatewayWarning(),i.payment_method=this.currentPaymentMethod,i.payment_method_handler=this.paymentMethodsMap[this.currentPaymentGateway][this.currentPaymentMethod].payment_method,i.payment_method_disclaimer=this.getCurrentPaymentMethodDisclaimer(),i.fields_list=this.fieldList,i.field_value_assoc=[],a.find("input[name]").each((function(){i.field_value_assoc[jQuery(this).attr("name")]=jQuery(this).val()})),PaymentPage.Template.load(a,"payment-form","template/payment-information.html",i,(function(){n.paymentGateway[n.currentPaymentGateway].mountPaymentMethod(n.currentPaymentMethod),n._bindFormFields(),n._maybeEnablePaymentTrigger()}))},afterPaymentFailed:function(e=""){this.paymentTriggerObject.removeAttr("disabled"),this.paymentTriggerAlternativeContainerObject.removeAttr("disabled"),this.container.find(":input").removeAttr("disabled"),this.__refreshPaymentTriggerText(),!1!==e&&("string"==typeof e&&e.length>1?this.paymentTriggerObject.after('<div data-payment-page-notification="danger">'+e+"</div>"):""!==this.configuration.lang.notification_payment_failed&&this.paymentTriggerObject.after('<div data-payment-page-notification="danger">'+this.configuration.lang.notification_payment_failed+"</div>"))},afterPaymentSuccessURLCallback:function(e){if(payment_page_in_array("redirect_to",this.configuration.submit_actions)&&""!==this.configuration.success_redirect_location){let t=this.configuration.success_redirect_location;return t+=(-1===t.indexOf("?")?"?":"&")+"title="+encodeURIComponent(this.configuration.lang.confirmation_page_title),t+="&message="+encodeURIComponent(this.configuration.lang.confirmation_page_message),t+="&payment_date="+encodeURIComponent(payment_page_format_timestamp_for_current_user(Math.floor(Date.now()/1e3))),t+="&item="+e.get("item"),t+="&currency="+e.get("currency"),t+="&payment_amount="+e.get("payment_amount"),t+="&customer_name="+e.get("customer_name"),t+="&email_address="+e.get("email_address"),void(window.location=t)}if(payment_page_in_array("dynamic_message",this.configuration.submit_actions))return void this.__paymentSuccessMessageDynamic(decodeURIComponent(e.get("item")),decodeURIComponent(e.get("payment_amount")),decodeURIComponent(e.get("currency")),decodeURIComponent(e.get("customer_name")),decodeURIComponent(e.get("email_address")),decodeURIComponent(e.get("payment_gateway")),decodeURIComponent(e.get("payment_method_handler")));e.delete("item"),e.delete("payment_amount"),e.delete("currency"),e.delete("customer_name"),e.delete("email_address"),e.delete("payment_method_handler"),e.delete("redirect_status"),e.delete("payment_intent"),e.delete("payment_intent_client_secret");let t=e.toString();window.location.href="?refresh=1"+(""===t?"":"&"+t)},afterPaymentSuccess:function(){if(payment_page_in_array("redirect_to",this.configuration.submit_actions)&&""!==this.configuration.success_redirect_location)return void(window.location=this.attachPaymentInformationParams(this.configuration.success_redirect_location,!0));let e=this.getCheckoutInformation();payment_page_in_array("dynamic_message",this.configuration.submit_actions)?this.__paymentSuccessMessageDynamic(e.title,void 0!==e.price_setup?e.price_setup:e.price,e.currency,this.container.find('[name="first_name"]').val()+" "+this.container.find('[name="last_name"]').val(),this.container.find('[name="email_address"]').val(),this.currentPaymentGateway,this.paymentGateway[this.currentPaymentGateway]._getCurrentPaymentMethodHandlerString()):window.location.reload()},__paymentSuccessMessageDynamic:function(e,t,n,a,i,r,o){let c=this,s={lang:this.configuration.lang,title:this.configuration.lang.confirmation_page_title,message:this.configuration.lang.confirmation_page_message,item:e,payment_date:payment_page_format_timestamp_for_current_user(Math.floor(Date.now()/1e3)),currency:n,payment_amount:t,customer_name:a,email_address:i,has_payment_details:this.configuration.success_has_payment_details,payment_method_handler:o};PaymentPage.Template.load(this.container,"payment-form","template/success.html",s,(function(){c.container[0].scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}))},canEnablePaymentTrigger:function(){let e=this.paymentGateway[this.currentPaymentGateway].maybeEnablePaymentTrigger();return e&&(""!==this.container.find('[name="first_name"]').val()&&""!==this.container.find('[name="last_name"]').val()&&""!==this.container.find('[name="email_address"]').val()&&payment_page_is_valid_email(this.container.find('[name="email_address"]').val())?this.container.find("input[name][required]").each((function(){""===jQuery(this).val()&&(e=!1)})):e=!1),e},_maybeEnablePaymentTrigger:function(){this.canEnablePaymentTrigger()?(this.paymentTriggerObject.removeAttr("disabled"),this.paymentTriggerAlternativeContainerObject.removeAttr("disabled")):(this.paymentTriggerObject.attr("disabled","disabled"),this.paymentTriggerAlternativeContainerObject.attr("disabled","disabled"))},attachPaymentInformationParams:function(e,t){let n=this.getCheckoutInformation();return t&&(e+=(-1===e.indexOf("?")?"?":"&")+"title="+encodeURIComponent(this.configuration.lang.confirmation_page_title),e+="&message="+encodeURIComponent(this.configuration.lang.confirmation_page_message),e+="&payment_date="+encodeURIComponent(payment_page_format_timestamp_for_current_user(Math.floor(Date.now()/1e3)))),e+=(-1===e.indexOf("?")?"?":"&")+"item="+encodeURIComponent(n.title),e+="&currency="+encodeURIComponent(n.currency),e+="&payment_amount="+encodeURIComponent(n.price),e+="&customer_name="+encodeURIComponent(this.container.find('[name="first_name"]').val()+" "+this.container.find('[name="last_name"]').val()),e+="&email_address="+encodeURIComponent(this.container.find('[name="email_address"]').val()),e+="&payment_gateway="+encodeURIComponent(this.currentPaymentGateway),e+="&payment_method_handler="+encodeURIComponent(this.paymentGateway[this.currentPaymentGateway]._getCurrentPaymentMethodHandlerString())},getCurrentPaymentMethodDisclaimer:function(){return void 0!==this.paymentMethodsMap[this.currentPaymentGateway][this.currentPaymentMethod].disclaimer?this.paymentMethodsMap[this.currentPaymentGateway][this.currentPaymentMethod].disclaimer:""},getCurrentPaymentGatewayWarning:function(){return void 0!==this.configuration.payment_gateways[this.currentPaymentGateway].warning?this.configuration.payment_gateways[this.currentPaymentGateway].warning:""},getCustomFieldsData:function(){let e={};return this.container.find('input[name^="custom_"]').each((function(){e[jQuery(this).parent().find("> label").text()]=jQuery(this).val()})),"object"==typeof this._hiddenFields&&Object.keys(this._hiddenFields).length>0&&jQuery.each(this._hiddenFields,(function(t,n){e[t]=n})),e},attachRestRequestCustomerDetails:function(e){return e.first_name=this.container.find('[name="first_name"]').val(),e.last_name=this.container.find('[name="last_name"]').val(),e.email_address=this.container.find('[name="email_address"]').val(),e}},PaymentPage.Component["payment-form"].paymentGateway.paypal={controllerInstance:null,buttonsInstance:null,_paypalSDKSettings:{currency:"",is_subscription:"",_rendering_timestamp:0},_init:function(e,t){this.controllerInstance=e,void 0!==window.paypal&&this.unMountPaymentMethod(),t()},_getCurrentPaymentMethodHandlerString:function(){return this._getPaymentMethodHandlerString(this.controllerInstance.currentPaymentMethod)},_getPaymentMethodHandlerString:function(e){return this.controllerInstance.paymentMethodsMap.paypal[e].payment_method},mountPaymentMethod:function(e,t=!1){"standard_checkout"===this._getCurrentPaymentMethodHandlerString(e)&&this._renderStandardCheckoutButtons()},unMountPaymentMethod:function(){null!==this.buttonsInstance&&"function"==typeof this.buttonsInstance.close&&this.buttonsInstance.close(),this.buttonsInstance=null,void 0!==window.paypal&&"function"==typeof window.paypal.__internal_destroy__&&window.paypal.__internal_destroy__(),jQuery("#payment-page-paypal-sdk").remove(),window.paypal=void 0},onPaymentTermsChange:function(e){"standard_checkout"===this._getPaymentMethodHandlerString(e)&&this._renderStandardCheckoutButtons()},maybeEnablePaymentTrigger:function(){return!0},_renderStandardCheckoutButtons:function(){let e=this,t=e.controllerInstance.getCheckoutInformation();if("one-time"!==t.frequency)return this.unMountPaymentMethod(),void e.controllerInstance.paymentTriggerAlternativeContainerObject.html('<div data-payment-page-notification="danger">Not available</div>').show();if(!(Math.ceil(Date.now()/1e3)-this._paypalSDKSettings._rendering_timestamp<1)){if(void 0===window.paypal||this._paypalSDKSettings.currency!==t.currency||this._paypalSDKSettings.is_subscription!==("one-time"!==t.frequency)){this._paypalSDKSettings._rendering_timestamp=Math.ceil(Date.now()/1e3),this._paypalSDKSettings.currency=t.currency,this._paypalSDKSettings.is_subscription="one-time"!==t.frequency,null!==this.buttonsInstance&&this.unMountPaymentMethod();let n="https://www.paypal.com/sdk/js?client-id="+this.controllerInstance.configuration.payment_gateways.paypal.client_id;n+="&components=buttons&currency="+t.currency.toUpperCase()+"&vault=true",this._paypalSDKSettings.is_subscription&&(n+="&intent=subscription");const a=document.createElement("script");return a.id="payment-page-paypal-sdk",a.src=n,jQuery("head").append(a),void(void 0!==window.paypal?e.__renderStandardCheckoutButtonsSDKReady():(e.controllerInstance.paymentTriggerAlternativeContainerObject.html(payment_page_element_loader("mini")).show(),setTimeout((function(){void 0!==window.paypal?e.__renderStandardCheckoutButtonsSDKReady():setTimeout((function(){e.__renderStandardCheckoutButtonsSDKReady()}),5e3)}),2e3)))}this.__renderStandardCheckoutButtonsSDKReady()}},__renderStandardCheckoutButtonsSDKReady:function(){let e=this
;if(this.controllerInstance.paymentTriggerAlternativeContainerObject.attr("data-payment-page-size","wide").show(),null===this.buttonsInstance&&void 0!==window.paypal&&void 0!==window.paypal.FUNDING){let t=e.controllerInstance.getCheckoutInformation(),n={fundingSource:window.paypal.FUNDING.PAYPAL,onApprove:function(t,n){return n.order.capture().then((function(t){e.controllerInstance.afterPaymentSuccess()}))},onCancel:function(){e.__displayFormFields()},onError:function(){e.__displayFormFields()},style:{layout:"vertical",label:"paypal"}};if("one-time"!==t.frequency)return e.controllerInstance.paymentTriggerAlternativeContainerObject.html(payment_page_element_loader("mini")).show(),void e.___renderStandardCheckoutButtonsSDKReadySubscription(n);n.createOrder=function(t,n){e.__hideFormFields();let a=e.controllerInstance.getCheckoutInformation();return n.order.create({payer:{name:{given_name:e.controllerInstance.container.find('[name="first_name"]').val(),surname:e.controllerInstance.container.find('[name="last_name"]').val()},email_address:e.controllerInstance.container.find('[name="email_address"]').val()},purchase_units:[{description:a.title,amount:{currency_code:a.currency.toUpperCase(),value:a.price}}]})},this.buttonsInstance=window.paypal.Buttons(n)}0===this.controllerInstance.paymentTriggerAlternativeContainerObject.find(".paypal-buttons").length&&(this.controllerInstance.paymentTriggerAlternativeContainerObject.html(""),this.buttonsInstance.render("#"+this.controllerInstance.paymentTriggerAlternativeContainerObject.attr("id")))},__hideFormFields:function(){this.controllerInstance.container.find('[data-payment-page-component-payment-form-section="field_wrapper"]').slideUp("slow")},__displayFormFields:function(){this.controllerInstance.container.find('[data-payment-page-component-payment-form-section="field_wrapper"]').slideDown("slow")},___renderStandardCheckoutButtonsSDKReadySubscription:function(e){this.buttonsInstance=window.paypal.Buttons(e),this.controllerInstance.paymentTriggerAlternativeContainerObject.html(""),this.buttonsInstance.render("#"+this.controllerInstance.paymentTriggerAlternativeContainerObject.attr("id"))}},PaymentPage.Component["payment-form"].paymentGateway.skeleton={controllerInstance:null,_init:function(e,t){this.controllerInstance=e,t()},_getCurrentPaymentMethodHandlerString:function(){return"skeleton"},_getPaymentMethodHandlerString:function(e){return"Demo Preview"},mountPaymentMethod:function(e,t=!1){},unMountPaymentMethod:function(){},onPaymentTermsChange:function(e){},maybeEnablePaymentTrigger:function(){return!0},__hideFormFields:function(){this.controllerInstance.container.find('[data-payment-page-component-payment-form-section="field_wrapper"]').slideUp("slow")},__displayFormFields:function(){this.controllerInstance.container.find('[data-payment-page-component-payment-form-section="field_wrapper"]').slideDown("slow")}},PaymentPage.Component["payment-form"].paymentGateway.stripe={controllerInstance:null,_stripeSDK:null,_stripeElements:null,cardElement:null,expiryElement:null,cvcElement:null,ibanElement:null,paymentRequestObject:null,paymentRequestButtonObject:null,labelObject:{card:null,expiry:null,cvc:null,iban:null},isEmpty:{card:!0,expiry:!0,cvc:!0,iban:!0},isValid:{card:!1,expiry:!1,cvc:!1,iban:!1},_init:function(e,t){this.controllerInstance=e;let n=this;void 0!==window.Stripe?n.__initStripeSDKLoaded(t):PaymentPage.LoadAssets("https://js.stripe.com/v3/",(function(){n.__initStripeSDKLoaded(t)}),!1)},__initStripeSDKLoaded:function(e){null===this._stripeSDK&&(this._stripeSDK=window.Stripe(this.controllerInstance.configuration.payment_gateways.stripe.publishable_key,{apiVersion:"2020-08-27"})),e()},_getCurrentPaymentMethodHandlerString:function(){return this._getPaymentMethodHandlerString(this.controllerInstance.currentPaymentMethod)},_getPaymentMethodHandlerString:function(e){return this.controllerInstance.paymentMethodsMap.stripe[e].payment_method},mountPaymentMethod:function(e,t=!1){let n=this._getCurrentPaymentMethodHandlerString(e);"ccard"===n?this._mountCreditCard():"sepa"===n?this._mountSEPA():"ach_direct_debit"===n?this._mountACHDirectDebit():"alipay"===n?this._mountAliPay(t):"wechat"===n?this._mountWeChat(t):payment_page_in_array(n,["apple_pay","google_pay","microsoft_pay"])&&this._mountPaymentRequest(n,t)},onPaymentTermsChange:function(e){payment_page_in_array(this._getPaymentMethodHandlerString(e),["apple_pay","google_pay","microsoft_pay"])&&this.__syncPaymentRequestObject()},maybeEnablePaymentTrigger:function(){if("ccard"===this._getCurrentPaymentMethodHandlerString()){if(!this.isValid.card||!this.isValid.expiry||!this.isValid.cvc)return this.controllerInstance.paymentTriggerObject.attr("disabled","disabled"),!1;if(""===this.controllerInstance.container.find('[name="pp_zip"]').val())return this.controllerInstance.paymentTriggerObject.attr("disabled","disabled"),!1}return!0},_mountCreditCard:function(){let e=this;this._stripeElements=this._stripeSDK.elements(),this.cardElement=this._stripeElements.create("cardNumber",{style:this.__getStripeElementInputStyle()}),this.expiryElement=this._stripeElements.create("cardExpiry",{style:this.__getStripeElementInputStyle()}),this.cvcElement=this._stripeElements.create("cardCvc",{style:this.__getStripeElementInputStyle()}),this.cardElement.mount(document.querySelector("#payment-page-card_number-"+this.controllerInstance.configuration.uniqid)),this.expiryElement.mount(document.querySelector("#payment-page-card_expiration_date-"+this.controllerInstance.configuration.uniqid)),this.cvcElement.mount(document.querySelector("#payment-page-card_cvc-"+this.controllerInstance.configuration.uniqid)),this.labelObject.card=this.controllerInstance.container.find('label[for="payment-page-card_number-'+this.controllerInstance.configuration.uniqid+'"]'),this.labelObject.expiry=this.controllerInstance.container.find('label[for="payment-page-card_expiration_date-'+this.controllerInstance.configuration.uniqid+'"]'),this.labelObject.cvc=this.controllerInstance.container.find('label[for="payment-page-card_cvc-'+this.controllerInstance.configuration.uniqid+'"]'),this.cardElement.on("focus",(function(t){e.labelObject.card.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","focus")})),this.expiryElement.on("focus",(function(t){e.labelObject.expiry.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","focus")})),this.cvcElement.on("focus",(function(t){e.labelObject.cvc.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","focus")})),this.cardElement.on("blur",(function(t){e.labelObject.card.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state",e.isEmpty.card?"blur":e.isValid.card?"not-empty":"error")})),this.expiryElement.on("blur",(function(t){e.labelObject.expiry.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state",e.isEmpty.expiry?"blur":e.isValid.expiry?"not-empty":"error")})),this.cvcElement.on("blur",(function(t){e.labelObject.cvc.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state",e.isEmpty.cvc?"blur":e.isValid.cvc?"not-empty":"error")})),this.cardElement.on("change",(function(t){e.isEmpty.card=t.empty,t.error?(e.labelObject.card.attr("data-payment-page-interaction-state","error").html(t.error.message),e.isValid.card=!1):(e.labelObject.card.attr("data-payment-page-interaction-state","good").html(e.controllerInstance.configuration.field_map.card_number.label),e.isValid.card=!0),t.empty||e.labelObject.card.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","not-empty"),e.controllerInstance._maybeEnablePaymentTrigger()})),this.expiryElement.on("change",(function(t){e.isEmpty.expiry=t.empty,t.error?(e.labelObject.expiry.attr("data-payment-page-interaction-state","error").html(t.error.message),e.isValid.expiry=!1):(e.labelObject.expiry.attr("data-payment-page-interaction-state","good").html(e.controllerInstance.configuration.field_map.card_expiration_date.label),e.isValid.expiry=!0),t.empty||e.labelObject.expiry.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","not-empty"),e.controllerInstance._maybeEnablePaymentTrigger()})),this.cvcElement.on("change",(function(t){e.isEmpty.cvc=t.empty,t.error?(e.labelObject.cvc.attr("data-payment-page-interaction-state","error").html(t.error.message),e.isValid.cvc=!1):(e.labelObject.cvc.attr("data-payment-page-interaction-state","good").html(e.controllerInstance.configuration.field_map.card_cvc.label),e.isValid.cvc=!0),t.empty||e.labelObject.cvc.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","not-empty"),e.controllerInstance._maybeEnablePaymentTrigger()})),this.controllerInstance.paymentTriggerObject.off("click").on("click",(function(){void 0===jQuery(this).attr("disabled")&&(jQuery(this).find(".payment-page-application-loader-wrapper").length>0||(e.controllerInstance.paymentTriggerObject.parent().find("[data-payment-page-notification]").remove(),jQuery(this).attr("disabled","disabled"),PaymentPage.setLoadingContent(jQuery(this),"","mini"),e.__createPaymentMethodCreditCard()))})),this.controllerInstance.paymentTriggerObject.show()},_mountSEPA:function(){let e=this;this._stripeElements=this._stripeSDK.elements(),this.ibanElement=this._stripeElements.create("iban",{style:this.__getStripeElementInputStyle(),supportedCountries:["SEPA"]}),this.ibanElement.mount(document.querySelector("#payment-page-iban-"+this.controllerInstance.configuration.uniqid)),this.labelObject.iban=this.controllerInstance.container.find('label[for="payment-page-iban-'+this.controllerInstance.configuration.uniqid+'"]'),this.ibanElement.on("focus",(function(t){e.labelObject.iban.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","focus")})),this.ibanElement.on("blur",(function(t){e.labelObject.iban.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state",e.isEmpty.iban?"blur":e.isValid.iban?"not-empty":"error")})),this.ibanElement.on("change",(function(t){e.isEmpty.iban=t.empty,t.error?(e.labelObject.iban.attr("data-payment-page-interaction-state","error").html(t.error.message),e.isValid.iban=!1):(e.labelObject.iban.attr("data-payment-page-interaction-state","good").html("IBAN"),e.isValid.iban=!0),t.empty||e.labelObject.iban.parents('[data-payment-page-component-payment-form-section="field"]').attr("data-payment-page-interaction-state","not-empty"),e.controllerInstance._maybeEnablePaymentTrigger()})),this.controllerInstance.paymentTriggerObject.off("click").on("click",(function(){void 0===jQuery(this).attr("disabled")&&(jQuery(this).find(".payment-page-application-loader-wrapper").length>0||(e.controllerInstance.paymentTriggerObject.parent().find("[data-payment-page-notification]").remove(),jQuery(this).attr("disabled","disabled"),PaymentPage.setLoadingContent(jQuery(this),"","mini"),e.__createPaymentMethodSEPADebit()))})),this.controllerInstance.paymentTriggerObject.show()},_mountACHDirectDebit:function(){let e=this;this.controllerInstance.paymentTriggerObject.off("click").on("click",(function(){void 0===jQuery(this).attr("disabled")&&(jQuery(this).find(".payment-page-application-loader-wrapper").length>0||(e.controllerInstance.paymentTriggerObject.parent().find("[data-payment-page-notification]").remove(),jQuery(this).attr("disabled","disabled"),PaymentPage.setLoadingContent(jQuery(this),"","mini"),e.__createPaymentMethodACHDirectDebit()))})),this.controllerInstance.paymentTriggerObject.show()},_mountAliPay:function(e=!1){let t=this;this.controllerInstance.paymentTriggerObject.off("click").on("click",(function(){void 0===jQuery(this).attr("disabled")&&(jQuery(this).find(".payment-page-application-loader-wrapper").length>0||(t.controllerInstance.paymentTriggerObject.parent().find("[data-payment-page-notification]").remove(),jQuery(this).attr("disabled","disabled"),PaymentPage.setLoadingContent(jQuery(this),"","mini"),t.__createPaymentIntentOrSetup("")))})),this.controllerInstance.paymentTriggerObject.show(),e&&t.controllerInstance.canEnablePaymentTrigger()&&this.controllerInstance.paymentTriggerObject.removeAttr("disabled").trigger("click")},_mountWeChat:function(e=!1){let t=this;this.controllerInstance.paymentTriggerObject.off("click").on("click",(function(){void 0===jQuery(this).attr("disabled")&&(jQuery(this).find(".payment-page-application-loader-wrapper").length>0||(t.controllerInstance.paymentTriggerObject.parent().find("[data-payment-page-notification]").remove(),jQuery(this).attr("disabled","disabled"),PaymentPage.setLoadingContent(jQuery(this),"","mini"),t.__createPaymentIntentOrSetup("")))})),this.controllerInstance.paymentTriggerObject.show(),e&&t.controllerInstance.canEnablePaymentTrigger()&&this.controllerInstance.paymentTriggerObject.removeAttr("disabled").trigger("click")},_mountPaymentRequest:function(e,t=!1){this.controllerInstance.paymentTriggerAlternativeContainerObject.show(),PaymentPage.setLoadingContent(this.controllerInstance.paymentTriggerAlternativeContainerObject,"","mini"),null===this.paymentRequestObject&&this.__syncPaymentRequestObject();let n=this;this.paymentRequestObject.canMakePayment().then((function(a){a&&("apple_pay"===e&&a.applePay||"google_pay"===e&&a.googlePay||"microsoft_pay"===e&&!a.applePay&&!a.googlePay)?(n.controllerInstance.paymentTriggerAlternativeContainerObject.html('<div data-payment-page-notification="info">'+n.controllerInstance.configuration.lang.payment_method_wallet_prerender+"</div>"),n._stripeElements=n._stripeSDK.elements(),n.paymentRequestButtonObject=n._stripeElements.create("paymentRequestButton",{paymentRequest:n.paymentRequestObject}),n.paymentRequestButtonObject.mount("#"+n.controllerInstance.paymentTriggerAlternativeContainerObject.attr("id")),t&&n.controllerInstance.canEnablePaymentTrigger()&&n.paymentRequestButtonObject.show()):n.controllerInstance.paymentTriggerAlternativeContainerObject.html('<div data-payment-page-notification="warning">'+n.controllerInstance.configuration.lang.payment_method_wallet_incompatible+"</div>")}))},__syncPaymentRequestObject:function(){if(!1===this.paymentRequestObject)return;let e=this.controllerInstance.getCheckoutInformation(),t=this;if(null===this.paymentRequestObject)try{this.paymentRequestObject=this._stripeSDK.paymentRequest({country:this.controllerInstance.configuration.payment_gateways.stripe.country_code,currency:e.currency,total:{label:e.title,amount:100*parseFloat(void 0!==e.price_setup?e.price_setup:e.price)},requestPayerName:!1,requestPayerEmail:!1}),this.paymentRequestObject.on("paymentmethod",(function(e){t.__createPaymentIntentOrSetup(e.paymentMethod.id,e)}))}catch(e){this.paymentRequestObject=!1}else this.paymentRequestObject.update({currency:e.currency,total:{label:e.title,amount:100*parseFloat(e.price)}})},__createPaymentMethodCreditCard:function(){let e=this,t={type:"card",card:this.cardElement,billing_details:{name:this.controllerInstance.container.find('[name="first_name"]').val()+" "+this.controllerInstance.container.find('[name="last_name"]').val()}};this.controllerInstance.container.find('[name="card_zip_code"]').length>0&&(t.billing_details.address={postal_code:this.controllerInstance.container.find('[name="card_zip_code"]').val()});this._stripeSDK.createPaymentMethod(t).then((function(t){t.error?e.controllerInstance.afterPaymentFailed(t.error.message):e.__createPaymentIntentOrSetup(t.paymentMethod.id)}))},__createPaymentMethodSEPADebit:function(){let e=this;this._stripeSDK.createPaymentMethod({type:"sepa_debit",sepa_debit:this.ibanElement,billing_details:{name:this.controllerInstance.container.find('[name="first_name"]').val()+" "+this.controllerInstance.container.find('[name="last_name"]').val(),email:this.controllerInstance.container.find('[name="email_address"]').val()}}).then((function(t){t.error?e.controllerInstance.afterPaymentFailed(t.error.message):e.__createPaymentIntentOrSetup(t.paymentMethod.id)}))},__createPaymentMethodACHDirectDebit:function(){let e=this,t=this.controllerInstance.getCheckoutInformation(),n=this.controllerInstance.attachRestRequestCustomerDetails({post_id:this.controllerInstance.configuration.post_id,price_frequency:t.frequency,price_currency:t.currency});PaymentPage.API.post("payment-page/v1/stripe/plaid-link-token",n,(function(t){t.message?e.controllerInstance.afterPaymentFailed(t.message):e.__createPaymentMethodACHDirectDebitPlaidLoaded(t)}))},__createPaymentMethodACHDirectDebitPlaidLoaded:function(e){let t=this;if(void 0===window.Plaid)return void PaymentPage.LoadAssets("https://cdn.plaid.com/link/v2/stable/link-initialize.js",(function(){t.__createPaymentMethodACHDirectDebitPlaidLoaded(e)}),!1);const n={token:e.link_token,onSuccess:function(e,n){if(n.accounts.length>=2)return void t.controllerInstance.afterPaymentFailed('Set <a href="https://dashboard.plaid.com/link/account-select" target="_blank">Select Account ></a> to Enabled for one account in the Plaid developer dashboard.');if(1!==n.accounts.length)return void t.controllerInstance.afterPaymentFailed("");let a=t.controllerInstance.getCheckoutInformation();PaymentPage.API.post("payment-page/v1/stripe/plaid-link-confirm",t.controllerInstance.attachRestRequestCustomerDetails({post_id:t.controllerInstance.configuration.post_id,product_title:a.title,price_frequency:a.frequency,price_currency:a.currency,price_amount:a.price,setup_price_amount:void 0!==a.price_setup?a.price_setup:null,custom_fields:t.controllerInstance.getCustomFieldsData(),plaid_public_token:e,plaid_bank_account_id:n.accounts[0].id}),(function(e){e.message?t.controllerInstance.afterPaymentFailed(e.message):t.controllerInstance.afterPaymentSuccess()}))},onExit:async function(e,n){null==e?t.controllerInstance.afterPaymentFailed(!1):t.controllerInstance.afterPaymentFailed("")}};window.Plaid.create(n).open()},__createPaymentIntentOrSetup:function(e,t){let n=this,a=this.controllerInstance.getCheckoutInformation(),i=this._getCurrentPaymentMethodHandlerString(),r=this.controllerInstance.attachRestRequestCustomerDetails({post_id:this.controllerInstance.configuration.post_id,product_title:a.title,price_frequency:a.frequency,price_currency:a.currency,price_amount:a.price,setup_price_amount:void 0!==a.price_setup?a.price_setup:null,stripe_payment_method_id:e,payment_method:i,custom_fields:this.controllerInstance.getCustomFieldsData()});PaymentPage.API.post("payment-page/v1/stripe/payment-intent-or-setup",r,(function(a){if(a.message)return void 0!==t&&"function"==typeof t.complete&&t.complete("fail"),void n.controllerInstance.afterPaymentFailed(a.message);"ccard"===i?n.__afterPaymentIntentOrSetupCreatedCCard(a,e):"sepa"===i?n.__afterPaymentIntentOrSetupCreatedSEPA(a,e):"alipay"===i?n.__afterPaymentIntentOrSetupCreatedAliPay(a):"wechat"===i?n.__afterPaymentIntentOrSetupCreatedWeChatPay(a):"apple_pay"!==i&&"google_pay"!==i&&"microsoft_pay"!==i||n.__afterPaymentIntentOrSetupCreatedCCard(a,e,t)}))},__afterPaymentIntentOrSetupCreatedCCard:function(e,t,n){let a=this;void 0!==e.payment_intent_id?e.payment_intent_requires_action?a._stripeSDK.confirmCardPayment(e.payment_intent_secret,{payment_method:t}).then((function(e){if(e.error)return void 0!==n&&"function"==typeof n.complete&&n.complete("fail"),void a.controllerInstance.afterPaymentFailed(e.error.message);a.__checkout(t,e.paymentIntent.id,n)})):a.__checkout(t,e.payment_intent_id,n):a._stripeSDK.confirmCardSetup(e.setup_intent_secret,{payment_method:t}).then((function(e){if(e.error)return void 0!==n&&"function"==typeof n.complete&&n.complete("fail"),void a.controllerInstance.afterPaymentFailed(e.error.message);a.__checkout(t,e.setupIntent.id,n)}))},__afterPaymentIntentOrSetupCreatedSEPA:function(e,t){let n=this;void 0!==e.payment_intent_id?e.payment_intent_requires_action?n._stripeSDK.confirmSepaDebitPayment(e.payment_intent_secret,{payment_method:t}).then((function(e){e.error?n.controllerInstance.afterPaymentFailed(e.error.message):n.__checkout(t,e.paymentIntent.id)})):n.__checkout(t,e.payment_intent_id):n._stripeSDK.confirmSepaDebitSetup(e.setup_intent_secret,{payment_method:t}).then((function(e){e.error?n.controllerInstance.afterPaymentFailed(e.error.message):n.__checkout(t,e.setupIntent.id)}))},__afterPaymentIntentOrSetupCreatedAliPay:function(e){void 0!==e.payment_intent_id&&this._stripeSDK.confirmAlipayPayment(e.payment_intent_secret,{return_url:this.controllerInstance.attachPaymentInformationParams(window.location.href,!1)}).then((function(e){e.error}))},__afterPaymentIntentOrSetupCreatedWeChatPay:function(e){let t=this;void 0!==e.payment_intent_id&&this._stripeSDK.confirmWechatPayPayment(e.payment_intent_secret,{payment_method_options:{wechat_pay:{client:"web"}}}).then((function(e){void 0!==e.paymentIntent&&"succeeded"===e.paymentIntent.status?t.controllerInstance.afterPaymentSuccess():t.controllerInstance.afterPaymentFailed(void 0!==e.error?e.error.message:"")}))},__checkout:function(e,t,n){let a=this,i=this.controllerInstance.getCheckoutInformation(),r=this.controllerInstance.attachRestRequestCustomerDetails({post_id:a.controllerInstance.configuration.post_id,product_title:i.title,price_frequency:i.frequency,price_currency:i.currency,price_amount:i.price,setup_price_amount:void 0!==i.price_setup?i.price_setup:null,stripe_payment_method_id:e,stripe_payment_intent_or_setup_id:t,custom_fields:this.controllerInstance.getCustomFieldsData()});this.controllerInstance.container.find(":input").attr("disabled","disabled"),PaymentPage.API.post("payment-page/v1/stripe/checkout",r,(function(e){if(void 0!==e.message)return void 0!==n&&"function"==typeof n.complete&&n.complete("fail"),void a.controllerInstance.afterPaymentFailed("");void 0!==n&&"function"==typeof n.complete&&n.complete("success"),a.controllerInstance.afterPaymentSuccess()}))},__getStripeElementInputStyle:function(){return{base:{color:payment_page_css_variable_value(this.controllerInstance.container,"--payment-page-element-form-input-color"),fontSize:payment_page_css_variable_value(this.controllerInstance.container,"--payment-page-element-form-input-font-size"),"::placeholder":{color:payment_page_css_variable_value(this.controllerInstance.container,"--payment-page-element-form-input-placeholder-color"),fontSize:payment_page_css_variable_value(this.controllerInstance.container,"--payment-page-element-form-input-placeholder-font-size")}}}}};